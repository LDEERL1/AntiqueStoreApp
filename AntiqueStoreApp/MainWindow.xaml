<Window x:Class="AntiqueStoreApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Эхо Веков" Height="600" Width="800">
    <Window.Resources>
        <!-- Стиль для кнопок -->
        <Style x:Key="ButtonStyle" TargetType="Button">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Padding" Value="10,5"/>
            <Setter Property="Background" Value="#8B0000"/>
            <!-- Темно-бордовый цвет -->
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#660000"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="HorizontalAlignment" Value="Center"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Margin" Value="5"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#A52A2A"/>
                    <!-- Более светлый оттенок при наведении -->
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background" Value="#6B1C1C"/>
                    <!-- Темный оттенок при нажатии -->
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Стиль для вкладок -->
        <Style x:Key="TabItemStyle" TargetType="TabItem">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="#FF6347"/>
            <!-- Светло-красный оттенок -->
            <Setter Property="Padding" Value="10,5"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Background" Value="#F5F5F5"/>
            <!-- Общий фон для вкладок -->
            <Style.Triggers>
                <DataTrigger Binding="{Binding IsSelected, RelativeSource={RelativeSource Self}}" Value="True">
                    <Setter Property="Foreground" Value="#B22222"/>
                    <!-- Темно-красный цвет для выбранной вкладки -->
                    <Setter Property="Background" Value="#FFD700"/>
                    <!-- Золотистый фон для выбранной вкладки -->
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <!-- Стиль для DataGrid -->
        <Style TargetType="DataGrid">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Margin" Value="10"/>
            <Setter Property="AutoGenerateColumns" Value="True"/>
            <Setter Property="RowBackground" Value="#f5f5f5"/>
            <Setter Property="AlternatingRowBackground" Value="#e9e9e9"/>
            <Setter Property="BorderBrush" Value="#8B0000"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="SelectionUnit" Value="FullRow"/>
            <Setter Property="IsReadOnly" Value="True"/>
        </Style>
    </Window.Resources>

    <Grid>
        <TabControl x:Name="TabControl" SelectionChanged="TabControl_SelectionChanged">
            <!-- Вкладка Покупатели -->
            <TabItem Header="Покупатели" Style="{StaticResource TabItemStyle}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <!-- Строка для кнопок управления -->
                        <RowDefinition Height="Auto" />
                        <!-- Строка для фильтра -->
                        <RowDefinition Height="*" />
                        <!-- Строка для DataGrid -->
                    </Grid.RowDefinitions>

                    <!-- Кнопки управления -->
                    <StackPanel Orientation="Horizontal" Margin="10" Grid.Row="0" HorizontalAlignment="Center">
                        <Button Content="Добавить" Width="150" Margin="5" Click="AddCustomer" Style="{StaticResource ButtonStyle}" />
                        <Button Content="Редактировать" Width="150" Margin="5" Click="EditCustomer" Style="{StaticResource ButtonStyle}" />
                        <Button Content="Удалить" Width="150" Margin="5" Click="DeleteCustomer" Style="{StaticResource ButtonStyle}" />
                    </StackPanel>

                    <DataGrid x:Name="CustomersGrid" AutoGenerateColumns="False" ItemsSource="{Binding Customers}" Margin="10" Grid.Row="2">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ФИО" Binding="{Binding FullName}" />
                            <DataGridTextColumn Header="Контактные данные" Binding="{Binding ContactDetails}" />
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- Вкладка Поставщики -->
            <TabItem Header="Поставщики" Style="{StaticResource TabItemStyle}">
                <Grid Background="#F0F8FF">
                    <!-- Голубой фон для вкладки Поставщики -->
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <!-- Строка для кнопок -->
                        <RowDefinition Height="*" />
                        <!-- Строка для DataGrid -->
                    </Grid.RowDefinitions>

                    <StackPanel Orientation="Horizontal" Margin="10" Grid.Row="0" HorizontalAlignment="Center">
                        <Button Content="Добавить" Width="150" Margin="5" Click="AddSupplier" Style="{StaticResource ButtonStyle}" />
                        <Button Content="Редактировать" Width="150" Margin="5" Click="EditSupplier" Style="{StaticResource ButtonStyle}" />
                        <Button Content="Удалить" Width="150" Margin="5" Click="DeleteSupplier" Style="{StaticResource ButtonStyle}" />
                    </StackPanel>

                    <DataGrid x:Name="SuppliersGrid" AutoGenerateColumns="False" ItemsSource="{Binding Suppliers}" Margin="10" Grid.Row="1">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Название" Binding="{Binding Name}" />
                            <DataGridTextColumn Header="Контактные данные" Binding="{Binding ContactDetails}" />
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- Вкладка Товары -->
            <TabItem Header="Товары" Style="{StaticResource TabItemStyle}" HorizontalAlignment="Right" Margin="0,-1,-2,0" VerticalAlignment="Top" Width="82">
                <Grid Background="#E6E6FA">
                    <!-- Лавандовый фон для вкладки Товары -->
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <!-- Строка для кнопок -->
                        <RowDefinition Height="Auto" />
                        <!-- Строка для фильтров -->
                        <RowDefinition Height="Auto" />
                        <!-- Строка для DataGrid -->
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <!-- Кнопки управления -->
                    <StackPanel Orientation="Horizontal" Margin="10" Grid.Row="0" HorizontalAlignment="Center">
                        <Button Content="Добавить" Width="150" Margin="5" Click="AddProduct" Style="{StaticResource ButtonStyle}" />
                        <Button Content="Редактировать" Width="150" Margin="5" Click="EditProduct" Style="{StaticResource ButtonStyle}" />
                        <Button Content="Удалить" Width="150" Margin="5" Click="DeleteProduct" Style="{StaticResource ButtonStyle}" />
                    </StackPanel>

                    <!-- Фильтры -->
                    <StackPanel Orientation="Horizontal" Margin="10" Grid.Row="1" HorizontalAlignment="Center">
                        <!-- Фильтр по категории -->
                        <StackPanel Orientation="Vertical" Margin="5">
                            <TextBlock Text="Категория" Foreground="Gray" />
                            <ComboBox x:Name="CategoryFilter" Width="150" Margin="5" SelectionChanged="FilterProducts" />
                        </StackPanel>

                        <!-- Фильтр по поставщику -->
                        <StackPanel Orientation="Vertical" Margin="5">
                            <TextBlock Text="Поставщик" Foreground="Gray" />
                            <ComboBox x:Name="SupplierFilter" Width="150" Margin="5" SelectionChanged="FilterProducts" />
                        </StackPanel>

                        <!-- Фильтр по состоянию -->
                        <StackPanel Orientation="Vertical" Margin="5">
                            <TextBlock Text="Состояние" Foreground="Gray" />
                            <ComboBox x:Name="ConditionFilter" Width="150" Margin="5" SelectionChanged="FilterProducts" />
                        </StackPanel>

                        <!-- Кнопка сброса фильтров -->
                        <Button Content="Сбросить фильтры" Width="150" Margin="5" Click="ResetFilters" Style="{StaticResource ButtonStyle}" />
                    </StackPanel>

                    <!-- Таблица DataGrid -->
                    <DataGrid x:Name="ProductsGrid" AutoGenerateColumns="False" Margin="10" Grid.Row="3">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Название товара" Binding="{Binding Name}" />
                            <DataGridTextColumn Header="Описание" Binding="{Binding Description}" />
                            <DataGridTextColumn Header="Цена" Binding="{Binding Price}" />
                            <DataGridTextColumn Header="Год" Binding="{Binding Year}" />
                            <DataGridTextColumn Header="Категория" Binding="{Binding Category}" />
                            <DataGridTextColumn Header="Состояние" Binding="{Binding Condition}" />
                            <!-- Колонка для названия поставщика -->
                            <DataGridTextColumn Header="Поставщик" Binding="{Binding Supplier.Name}" Width="200" />

                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <TabItem Header="Заказы" Style="{StaticResource TabItemStyle}">
                <Grid Background="#FFFACD">
                    <!-- Светло-желтый фон для вкладки Заказы -->
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <!-- Первая строка с кнопками (Фильтры и Экспорт) -->
                    <StackPanel Orientation="Horizontal" Margin="10" Grid.Row="0" HorizontalAlignment="Center">
                        <Button Content="Фильтр по дате" Width="150" Margin="5" Click="FilterOrdersByDate" Style="{StaticResource ButtonStyle}" />
                        <Button Content="Сбросить фильтр" Width="150" Margin="5" Click="ResetOrdersFilter" Style="{StaticResource ButtonStyle}" />
                    </StackPanel>

                    <!-- Вторая строка с кнопками (Добавить, Редактировать, Удалить) -->
                    <StackPanel Orientation="Horizontal" Margin="10" Grid.Row="1" HorizontalAlignment="Center">
                        <Button Content="Добавить" Width="150" Margin="5" Click="AddOrder" Style="{StaticResource ButtonStyle}" />
                        <Button Content="Редактировать" Width="150" Margin="5" Click="UpdateOrder" Style="{StaticResource ButtonStyle}" />
                        <Button Content="Удалить" Width="150" Margin="5" Click="DeleteOrder" Style="{StaticResource ButtonStyle}" />
                    </StackPanel>

                    <!-- DataGrid для отображения заказов -->
                    <DataGrid x:Name="OrdersGrid" AutoGenerateColumns="False" ItemsSource="{Binding Orders}" Margin="10" Grid.Row="2">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID Заказа" Binding="{Binding OrderID}" Width="100" />
                            <DataGridTextColumn Header="Дата" Binding="{Binding OrderDate, StringFormat={}{0:yyyy-MM-dd}}" Width="150" />
                            <DataGridTextColumn Header="Покупатель" Binding="{Binding CustomerFullName}" Width="200" />
                            <DataGridTextColumn Header="Общая стоимость" Binding="{Binding TotalPrice}" Width="150" />
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>


            <TabItem Header="Детали заказов" Style="{StaticResource TabItemStyle}">
                <Grid Background="#F5F5DC">
                    <!-- Бежевый фон для вкладки Детали заказов -->
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <!-- Первая строка с кнопками (Экспорт) -->
                    <StackPanel Orientation="Horizontal" Margin="10" Grid.Row="0" HorizontalAlignment="Center">
                        <Button Content="Экспорт в Excel" Width="150" Margin="5" Click="ExportFilteredOrderDetailsToExcel" Style="{StaticResource ButtonStyle}" />

                    </StackPanel>

                    <!-- Вторая строка с фильтрами -->
                    <StackPanel Orientation="Horizontal" Margin="10" Grid.Row="1" HorizontalAlignment="Center">
                        <TextBlock Text="Введите номер заказа" Foreground="Gray" VerticalAlignment="Center" Margin="5,0,0,0"/>
                        <TextBox x:Name="OrderFilterTextBox" Width="200" Margin="5" />
                        <Button Content="Применить фильтр" Click="FilterOrderDetails" Width="155" Margin="5" />
                        <Button Content="Сбросить фильтр" Click="ResetOrderFilter" Width="150" Margin="5" />
                    </StackPanel>

                    <!-- DataGrid для отображения деталей заказов -->
                    <DataGrid x:Name="OrderDetailsGrid" AutoGenerateColumns="False" ItemsSource="{Binding OrderDetails}" Margin="10" Grid.Row="2">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID Заказа" Binding="{Binding OrderID}" />
                            <DataGridTextColumn Header="Товар" Binding="{Binding ProductName}" />
                            <DataGridTextColumn Header="Количество" Binding="{Binding Quantity}" />
                            <DataGridTextColumn Header="Цена" Binding="{Binding Price}" />
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>



            <!-- Вкладка Склад -->
            <TabItem Header="Склад" Style="{StaticResource TabItemStyle}">
                <Grid Background="#F0FFF0">
                    <!-- Светло-зеленый фон для вкладки Склад -->
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <!-- Строка для кнопок -->
                        <RowDefinition Height="*" />
                        <!-- Строка для DataGrid -->
                    </Grid.RowDefinitions>

                    <StackPanel Orientation="Horizontal" Margin="10" Grid.Row="0" HorizontalAlignment="Center">
                        <Button Content="Добавить" Width="150" Margin="5" Click="AddWarehouse" Style="{StaticResource ButtonStyle}" />
                        <Button Content="Редактировать" Width="150" Margin="5" Click="EditWarehouse" Style="{StaticResource ButtonStyle}" />
                        <Button Content="Удалить" Width="150" Margin="5" Click="DeleteWarehouse" Style="{StaticResource ButtonStyle}" />
                    </StackPanel>

                    <DataGrid x:Name="WarehouseGrid" AutoGenerateColumns="False" Margin="10" Grid.Row="1">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Название товара" Binding="{Binding ProductName}" />
                            <DataGridTextColumn Header="Количество" Binding="{Binding Quantity}" />
                            <DataGridTextColumn Header="Место" Binding="{Binding Location}" />
                            <DataGridTextColumn Header="Дата поступления" Binding="{Binding ArrivalDate, StringFormat='yyyy-MM-dd'}" />
                            <DataGridTextColumn Header="Статус" Binding="{Binding Status}" />
                            <DataGridTextColumn Header="Дата заказа" Binding="{Binding OrderedDate, StringFormat='yyyy-MM-dd'}" />
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>
        </TabControl>
    </Grid>
</Window>
